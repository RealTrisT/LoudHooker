#pragma once

char WebsocketResponse[130] = "\
HTTP/1.1 101 Switching Protocols\r\n\
Upgrade: websocket\r\n\
Connection: Upgrade\r\n\
Sec-WebSocket-Accept: 0000000000000000000000000000\r\n\
\r\n";



#define pagesize 15573
#define full_page_size 15664

char* hackpage = "HTTP/1.1 200 OK\r\nContent-Type : text/html\r\nServer : BitchPlease\r\nContent-Length : 15572\r\n\r\n<!DOCTYPE html>\r\n<html>\r\n<head>\r\n	<title>misspellings</title>\r\n	<script src=\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\"></script>\r\n	<script type=\"text/javascript\">\r\n\r\n		MaxBreakpoints = 5; /*0 - 9, otherwise will break (I actually have no patience to be checking them numbers)*/\r\n		var re = /^[0-9a-fA-F]+$/;\r\n		HookSocket = 0;\r\n\r\n\r\n\r\n\r\n		var XMMOptions_Specifier = \"<option value='XMM0'>XMM0</option><option value='XMM1'>XMM1</option><option value='XMM2'>XMM2</option><option value='XMM3'>XMM3</option><option value='XMM4'>XMM4</option><option value='XMM5'>XMM5</option><option value='XMM6'>XMM6</option><option value='XMM7'>XMM7</option><option value='XMM8'>XMM8</option><option value='XMM9'>XMM9</option><option value='XMM10'>XMM10</option><option value='XMM11'>XMM11</option><option value='XMM12'>XMM12</option><option value='XMM13'>XMM13</option><option value='XMM14'>XMM14</option><option value='XMM15'>XMM15</option>\";\r\n		var REGOptions_Specifier = \"<option value='RAX'>RAX</option><option value='RBX'>RBX</option><option value='RCX'>RCX</option><option value='RDX'>RDX</option><option value='RBP'>RBP</option><option value='RSP'>RSP</option><option value='RSI'>RSI</option><option value='RDI'>RDI</option><option value='R8'>R8</option><option value='R9'>R9</option><option value='R10'>R10</option><option value='R11'>R11</option><option value='R12'>R12</option><option value='R13'>R13</option><option value='R14'>R14</option><option value='R15'>R15</option>\";\r\n		var XMMFormatting_Specifier = \"<option value='f'>Float</option><option value='d'>Double</option>\";\r\n		var REGFormatting_Specifier = \"<option value='p'>Pointer</option><option value='s'>String</option><option value='u'>Unsigned</option><option value='d'>Signed</option><option value='f'>Float</option><option value='c'>Character</option><option value='X'>Hexadecimal</option><option value='o'>Octal</option>\";\r\n		var STCFormatting_Specifier = \"<option value='p'>Pointer</option><option value='s'>String</option><option value='u'>Unsigned</option><option value='d'>Signed</option><option value='F'>Float</option><option value='f'>Double</option><option value='c'>Character</option><option value='X'>Hexadecimal</option><option value='o'>Octal</option>\";\r\n\r\n		function escapeHtml(unsafe) {\r\n		    return unsafe\r\n		        .replace(/&/g, \"&amp;\")\r\n		        .replace(/</g, \"&lt;\")\r\n		        .replace(/>/g, \"&gt;\")\r\n		        .replace(/\"/g, \"&quot;\")\r\n		        .replace(/'/g, \"&#039;\");\r\n		}\r\n\r\n		function RecursiveJsonPrint(json){\r\n			var string = \"<font color='white' size='2'>[</font>\";\r\n			for (var i = 0; i < json.length; i++) {\r\n				if(i)string += \"<font color='white' size='2'>, </font>\";\r\n				if(json[i].constructor === Array)string += RecursiveJsonPrint(json[i]);\r\n				else string += \"<font color='#e93f3b' size='2'>\\\"\" + \r\n					json[i].replace(/&/g, \"&amp;\").replace(/</g, \"&lt;\").replace(/>/g, \"&gt;\").replace(/\"/g, \"&quot;\").replace(/'/g, \"&#039;\") + \r\n				\"\\\"</font>\";\r\n			}\r\n			string += \"<font color='white' size='2'>]</font>\";\r\n			return string;\r\n		}\r\n\r\n\r\n		function sockonmsg(event){\r\n			console.log(event.data);\r\n			var parsed = JSON.parse(event.data);\r\n			console.log(parsed);\r\n			var address = parsed[0];\r\n			parsed.splice(0, 1);\r\n			var newdiv = document.createElement(\"div\");\r\n			newdiv.className = \"entry\";\r\n			newdiv.innerHTML = \"<div class='args'>\" + RecursiveJsonPrint(parsed) + \"</div><div class='address'><font color='white' size='2'>\" + address + \"</font></div>\";\r\n			document.getElementById(\"log_\").appendChild(newdiv);\r\n		}\r\n		function sockonopen(){\r\n			console.log(\"CONNECTION OPEN\");\r\n			$(\"#ConnectButton\").prop('disabled', true);\r\n			$(\"#QuitButton\").prop('disabled', false);\r\n		}\r\n\r\n		function sockonclose(){\r\n			console.log(\"CONNECTION CLOSED\");\r\n			$(\"#ConnectButton\").prop('disabled', false);\r\n			$(\"#QuitButton\").prop('disabled', true);\r\n		}\r\n\r\n		$(document).ready(function(){\r\n\r\n			window.onbeforeunload = function(e) {\r\n				var dialog = \"You will break shit if you reload, and the dll won't \\\"eject\\\" if you close the page.\";\r\n				e.returnValue = dialog;\r\n        		return dialog;\r\n    		}\r\n\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			////////////////////////OPEN SOCKET AND CALLBACK////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			HookSocket = new WebSocket(\"ws://localhost:8081/.png\");\r\n			HookSocket.onopen = sockonopen;\r\n			HookSocket.onmessage = sockonmsg;\r\n			HookSocket.onclose = sockonclose;\r\n\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			///////////////////////////GENERATE INPUT FOR BPS///////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			var BreakpointInputs = \"\";\r\n			for (var i = 0; i < MaxBreakpoints; i++) {\r\n				BreakpointInputs += \"\\\r\n				\\\r\n				<div class='BreakpointInputs_Container' id='BreakpointInput_Container\" + i + \"'>\\\r\n					<hr>\\\r\n					<center><input type='checkbox' class='ActivationCheckbox' id='ActivationCheckbox\" + i + \"'></center>\\\r\n					<div class='BreakPointAddrInput_Container'>\\\r\n						<input type='text' class='BreakPointAddrInput' id='BreakPointAddrInput\" + i + \"'>\\\r\n					</div>\\\r\n					<br>\\\r\n					<center>\\\r\n						<div class='AddButton_Container'>\\\r\n							<button class='AddButton' id='AddButton\" + i + \"'>Add</button><button class='RemButton' id='RemButton\" + i + \"'>Remove</button>\\\r\n						</div>\\\r\n					</center>\\\r\n					<center><div class='FormatAdditions' id='FormatAdditions\" + i + \"'></div></center>\\\r\n				</div>\\\r\n				\";\r\n			}document.getElementById(\"commds\").innerHTML += BreakpointInputs;\r\n\r\n\r\n\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			////////////////////////////ADD BUTTON CLICK////////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(\".AddButton\").click(function(){\r\n				var PreviousElementList = document.getElementById(\"FormatAdditions\"+this.id[9]).getElementsByClassName(\"DataElement_Container\");\r\n				var CurrentIndex = (PreviousElementList)?PreviousElementList.length:0;\r\n				console.log(\"CurrentIndex: \" + CurrentIndex);\r\n				\r\n				var element 		= document.createElement(\"div\"); \r\n				element.className 	= \"DataElement_Container\"; \r\n				element.id 			= \"DataElement_Container\" + CurrentIndex;\r\n				element.innerHTML 	= \"\\\r\n					<select class='DataElement_Class' id='DataElement_Class\" + CurrentIndex + \"'>\\\r\n						<option value='X'>XMM</option>\\\r\n						<option value='R'>R*</option>\\\r\n						<option value='S'>Stack</option>\\\r\n					</select>\\\r\n					<div class='DataElement_Info' id='DataElement_Info\" + CurrentIndex + \"'>\\\r\n						<select class='DataElement_Specifier' id='DataElement_Specifier\" + CurrentIndex + \"'>\\\r\n							\" + XMMOptions_Specifier + \"\\\r\n						</select>\\\r\n						<select class='DataElement_Formatting' id='DataElement_Formatting\" + CurrentIndex + \"'>\\\r\n							\" + XMMFormatting_Specifier + \"\\\r\n						</select>\\\r\n					</div>\";\r\n\r\n				document.getElementById(\"FormatAdditions\"+this.id[9]).appendChild(element);\r\n			});\r\n\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			////////////////////////////REM BUTTON CLICK////////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(\".RemButton\").click(function(){\r\n				var PreviousElementList = document.getElementById(\"FormatAdditions\"+this.id[9]).getElementsByClassName(\"DataElement_Container\");\r\n				if(PreviousElementList && PreviousElementList.length)\r\n					document.getElementById(\"FormatAdditions\"+this.id[9]).removeChild(PreviousElementList[PreviousElementList.length-1]);\r\n			});\r\n\r\n			\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			///////////////////////////CLASS BUTTON CLICK///////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(document).on('change', '.DataElement_Class', function(){\r\n				/*//console.log(\"clicked\" + this.parentNode.getElementsByClassName(\"DataElement_Specifier\")[0]);*/\r\n				var text = \"\"; \r\n				if(this.value == \"X\"){\r\n					text = \"<select class='DataElement_Specifier' id='DataElement_Specifier\" + this.id[17] + \"'>\" + XMMOptions_Specifier + \"</select>\\\r\n							<select class='DataElement_Formatting' id='DataElement_Formatting\" + this.id[17] + \"'>\" + XMMFormatting_Specifier + \"</select>\";\r\n				}else if(this.value == \"R\"){\r\n					text = \"<select class='DataElement_Specifier' id='DataElement_Specifier\" + this.id[17] + \"'>\" + REGOptions_Specifier + \"</select>\\\r\n							<select class='DataElement_Formatting' id='DataElement_Formatting\" + this.id[17] + \"'>\" + REGFormatting_Specifier + \"</select>\";\r\n				}else if(this.value == \"S\"){\r\n					text = \"<input type='number' class='StackElement_Formatting' id='StackElement_Formatting\" + this.id[17] + \"'>\\\r\n							<select class='DataElement_Formatting' id='DataElement_Formatting\" + this.id[17] + \"'>\" + STCFormatting_Specifier + \"</select>\";\r\n				}\r\n				this.parentNode.getElementsByClassName(\"DataElement_Info\")[0].innerHTML = text;\r\n\r\n			});\r\n\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			///////////////////////////ACTIVE CHECKBOX CLICK////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(\".ActivationCheckbox\").on('change', function () {\r\n				var ch = $(this), c;\r\n				var contents = $(\"#BreakPointAddrInput\"+this.id[18]).val();\r\n				if(re.test(contents)){\r\n					if(this.checked ) {\r\n						var DataElementArry = document.getElementById(\"FormatAdditions\"+this.id[18]).getElementsByClassName(\"DataElement_Container\");\r\n						if(!DataElementArry || !DataElementArry.length){\r\n							alert(\"You need at least one Data Element bud.\"); \r\n							ch.prop('checked', false);\r\n							return;\r\n						}\r\n\r\n						var socksend = \"a\" + contents;\r\n\r\n						for (var i = 0; i < DataElementArry.length; i++) {\r\n							socksend += \" \";\r\n							if(DataElementArry[i].getElementsByClassName(\"DataElement_Class\")[0].value == \"S\"){ /*//stack*/\r\n								socksend += \"S\" + DataElementArry[i].getElementsByClassName(\"StackElement_Formatting\")[0].value + DataElementArry[i].getElementsByClassName(\"DataElement_Formatting\")[0].value;\r\n							}else{	/*//XMM or REG*/\r\n								socksend += DataElementArry[i].getElementsByClassName(\"DataElement_Specifier\")[0].value + DataElementArry[i].getElementsByClassName(\"DataElement_Formatting\")[0].value;\r\n							}\r\n						}\r\n\r\n						$(\"#AddButton\"+this.id[18]).prop('disabled', true);\r\n						$(\"#RemButton\"+this.id[18]).prop('disabled', true);\r\n						$(\"#BreakPointAddrInput\"+this.id[18]).prop('disabled', true);\r\n						$(\"#FormatAdditions\"+this.id[18]+\" input\").prop('disabled', true);\r\n						$(\"#FormatAdditions\"+this.id[18]+\" select\").prop('disabled', true);\r\n\r\n\r\n						console.log(socksend);\r\n						HookSocket.send(socksend);\r\n					} else {\r\n						$(\"#AddButton\"+this.id[18]).prop('disabled', false);\r\n						$(\"#RemButton\"+this.id[18]).prop('disabled', false);\r\n						$(\"#BreakPointAddrInput\"+this.id[18]).prop('disabled', false);\r\n						$(\"#FormatAdditions\"+this.id[18]+\" input\").prop('disabled', false);\r\n						$(\"#FormatAdditions\"+this.id[18]+\" select\").prop('disabled', false);\r\n\r\n						HookSocket.send(\"r\"+contents);\r\n					}\r\n				}else {\r\n					alert(\"invalid address\");\r\n					ch.prop('checked', false);\r\n				}\r\n			});\r\n\r\n			/*////////////////////////////////////////////////////////////////////////\r\n			////////////////////////////////CONN BUTTON/////////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(\"#ConnectButton\").click(function(){\r\n				HookSocket 			= new WebSocket(\"ws://localhost:8081/.png\");\r\n				HookSocket.onopen 	= sockonopen;\r\n				HookSocket.onmessage= sockonmsg;\r\n				HookSocket.onclose 	= sockonclose;\r\n			});\r\n\r\n			////////////////////////////////////////////////////////////////////////\r\n			////////////////////////////////QUIT BUTTON/////////////////////////////\r\n			////////////////////////////////////////////////////////////////////////\r\n			$(\"#QuitButton\").click(function(){\r\n				HookSocket.send(\"q\");\r\n			});\r\n\r\n			////////////////////////////////////////////////////////////////////////\r\n			/////////////////////////////////CLS BUTTON/////////////////////////////\r\n			////////////////////////////////////////////////////////////////////////*/\r\n			$(\"#ClearButton\").click(function(){\r\n				document.getElementById(\"log_\").innerHTML = \"\";\r\n			});\r\n\r\n			$(\".right\").width($(window).width() - 400);\r\n			window.onresize = function(){\r\n				$(\".right\").width($(window).width() - 400);\r\n			}\r\n		});	\r\n	</script>\r\n	<style type=\"text/css\">\r\n		html, body {\r\n		    /*max-height: 100%;*/\r\n			min-height: 100%; /*I AM FUCKING PISSED*/\r\n			max-height: 100%; /*I AM FUCKING PISSED*/\r\n			height: 100%;     /*I AM FUCKING PISSED*/\r\n\r\n		    margin: 0;\r\n		}\r\n\r\n		.wrapper {\r\n			min-height: 100%; /*I AM FUCKING PISSED*/\r\n			max-height: 100%; /*I AM FUCKING PISSED*/\r\n			height: 100%;     /*I AM FUCKING PISSED*/\r\n\r\n		    width: 100%;\r\n		}\r\n		.content {\r\n\r\n			min-height: 100%; /*I AM FUCKING PISSED*/\r\n			max-height: 100%; /*I AM FUCKING PISSED*/\r\n			height: 100%;     /*I AM FUCKING PISSED*/\r\n\r\n		    width: 100%;\r\n		    display: table;\r\n		}\r\n\r\n		.left, .right {\r\n			\r\n\r\n		    display: table-cell;\r\n		}\r\n\r\n		.left {\r\n\r\n			min-height: 100%; /*I AM FUCKING PISSED*/\r\n			max-height: 100%; /*I AM FUCKING PISSED*/\r\n			height: 100%;     /*I AM FUCKING PISSED*/\r\n\r\n			width: 350px;\r\n			max-width: 350px;\r\n			min-width: 350px;\r\n		    padding: 15px;\r\n		    background-color: lightgray;\r\n		}\r\n\r\n		.right {\r\n			position: fixed;\r\n			min-height: 100%; /*I AM FUCKING PISSED*/\r\n			max-height: 100%; /*I AM FUCKING PISSED*/\r\n			width: inherit;\r\n			overflow-y: scroll;\r\n			padding-left: 20px;\r\n		    background-color: #242424;\r\n		}\r\n\r\n\r\n		/*////////////////////////////////////*/\r\n		/*------------The Callbacks-----------*/\r\n		/*////////////////////////////////////*/\r\n		.formatting{\r\n			width: 100%;\r\n		}\r\n		.call{\r\n			border-width: 5px;\r\n			border-color: black;\r\n		}\r\n		.entry{\r\n			padding: 5px;\r\n			border-bottom: 1px solid #2b2b2b;\r\n			display: inline-grid;\r\n		}\r\n		.args{\r\n			/*float: left;*/\r\n		}\r\n		.address{\r\n			float: right;\r\n		}\r\n\r\n\r\n		/*////////////////////////////////////*/\r\n		/*-------------The Hooks--------------*/\r\n		/*////////////////////////////////////*/\r\n		select{\r\n			min-width: 100px;\r\n		}\r\n\r\n		.BreakpointInputs_Container, .BreakPointAddrInput {\r\n			width: 100%;			\r\n		}\r\n\r\n		.AddButton, .AddButton_Container, .ActivationCheckbox{\r\n			width: 50%;\r\n		}\r\n\r\n		.AddButton, .RemButton{\r\n			width: 60px;\r\n		}\r\n\r\n		#Stack_Measure{\r\n			width: 98px;\r\n		}\r\n\r\n		.FormatAdditions{\r\n			display: inline-block;\r\n		}\r\n\r\n		.DataElement_Info{\r\n			margin-left: 103px;\r\n		}\r\n		.DataElement_Class{\r\n			float: left;\r\n		}\r\n		.StackElement_Formatting{\r\n			width: 97px;\r\n		}\r\n		#log_{\r\n			\r\n		}\r\n\r\n\r\n</style>\r\n	</style>\r\n</head>\r\n	<body>\r\n\r\n		<div class=\"wrapper\">\r\n		    <div class=\"content\">\r\n		        <div class=\"left\" id=\"commds\">\r\n		        	<button id=\"ConnectButton\" style=\"width: 100%\">connect this bitch boi</button>\r\n		    		<button id=\"QuitButton\" style=\"width: 100%\" disabled=\"true\">quit this shit mang</button>\r\n		    		<br><br>\r\n		        	<button id=\"ClearButton\" style=\"width: 100%\">Clear</button>\r\n		        </div>\r\n		        <div class=\"right\">\r\n		        	<div id=\"log_\">\r\n		        		\r\n		        	</div>\r\n		        </div>\r\n		    </div>\r\n		</div>\r\n\r\n\r\n\r\n\r\n	</body>\r\n</html>";


